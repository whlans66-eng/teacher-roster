# å¾Œç«¯ API æ•´åˆå®Œæˆå ±å‘Š

## ğŸ“… æ—¥æœŸ
2025-11-03

## âœ… å®Œæˆé …ç›®

### 1. æ´¾èª²ç®¡ç†ï¼ˆcourseAssignmentsï¼‰èˆ‡å¾Œç«¯æ•´åˆ
- **æ–°å¢åŠŸèƒ½**ï¼š
  - `loadCourseAssignmentsFromBackend()` - å¾å¾Œç«¯è¼‰å…¥æ´¾èª²æ•¸æ“š
  - `saveCourseToBackend()` - å°‡æ´¾èª²æ•¸æ“šåŒæ­¥åˆ°å¾Œç«¯

- **ä¿®æ”¹å‡½æ•¸**ï¼š
  - `saveCourseLocal()` - ç¾åœ¨åŒæ™‚ä¿å­˜åˆ° localStorage å’Œå¾Œç«¯

- **ä½ç½®**ï¼š`teacher-management.html` ç¬¬ 2126-2143 è¡Œï¼ˆè¼‰å…¥ï¼‰ã€ç¬¬ 2489-2498 è¡Œï¼ˆä¿å­˜ï¼‰

### 2. æµ·äº‹èª²ç¨‹ï¼ˆmaritimeCoursesï¼‰èˆ‡å¾Œç«¯æ•´åˆ
- **æ–°å¢åŠŸèƒ½**ï¼š
  - `loadMaritimeCoursesFromBackend()` - å¾å¾Œç«¯è¼‰å…¥æµ·äº‹èª²ç¨‹æ•¸æ“š
  - `saveMaritimeCoursesToBackend()` - å°‡æµ·äº‹èª²ç¨‹æ•¸æ“šåŒæ­¥åˆ°å¾Œç«¯

- **ä¿®æ”¹å‡½æ•¸**ï¼š
  - `saveMaritimeCourses()` - ç¾åœ¨åŒæ™‚ä¿å­˜åˆ° localStorage å’Œå¾Œç«¯

- **ä½ç½®**ï¼š`teacher-management.html` ç¬¬ 2929-2958 è¡Œ

### 3. é é¢åˆå§‹åŒ–æ•´åˆ
- **ä¿®æ”¹ä½ç½®**ï¼š`teacher-management.html` ç¬¬ 1117-1119 è¡Œ
- **æ”¹å‹•**ï¼šåœ¨ `DOMContentLoaded` äº‹ä»¶ä¸­æ–°å¢ï¼š
  ```javascript
  await loadCourseAssignmentsFromBackend();
  await loadMaritimeCoursesFromBackend();
  ```

## ğŸ“Š æ•¸æ“šæµç¨‹

### è³‡æ–™è¼‰å…¥ï¼ˆé é¢å•Ÿå‹•æ™‚ï¼‰
```
é é¢è¼‰å…¥ â†’ DOMContentLoaded äº‹ä»¶
  â”œâ”€ è¼‰å…¥ teachersï¼ˆå·²æœ‰ï¼‰
  â”œâ”€ è¼‰å…¥ courseAssignmentsï¼ˆæ–°å¢ï¼‰âœ¨
  â””â”€ è¼‰å…¥ maritimeCoursesï¼ˆæ–°å¢ï¼‰âœ¨
```

### è³‡æ–™ä¿å­˜
```
ç”¨æˆ¶æ“ä½œ â†’ æ•¸æ“šè®Šæ›´
  â”œâ”€ ä¿å­˜åˆ° localStorageï¼ˆæœ¬åœ°å¿«å–ï¼‰
  â””â”€ åŒæ­¥åˆ°å¾Œç«¯ APIï¼ˆé›²ç«¯å„²å­˜ï¼‰âœ¨
```

## ğŸ”§ å¾Œç«¯ API ä½¿ç”¨

æ‰€æœ‰åŠŸèƒ½éƒ½ä½¿ç”¨ `js/api.js` ä¸­å®šç¾©çš„ APIï¼š

- **è®€å–**ï¼š`api.list('tableName')`
  - `api.list('teachers')`
  - `api.list('courseAssignments')` âœ¨
  - `api.list('maritimeCourses')` âœ¨

- **ä¿å­˜**ï¼š`syncManager.saveTable('tableName')`
  - `syncManager.saveTable('teachers')`
  - `syncManager.saveTable('courseAssignments')` âœ¨
  - `syncManager.saveTable('maritimeCourses')` âœ¨

## âœ¨ ä¸»è¦æ”¹é€²

1. **æ•¸æ“šæŒä¹…åŒ–**ï¼šæ‰€æœ‰æ•¸æ“šç¾åœ¨éƒ½æœƒè‡ªå‹•åŒæ­¥åˆ° Google Sheets
2. **å¤šè£ç½®åŒæ­¥**ï¼šä¸åŒè£ç½®å¯ä»¥å…±äº«åŒä¸€ä»½æ•¸æ“š
3. **å‚™ä»½ä¿è­·**ï¼šå³ä½¿æ¸…é™¤ç€è¦½å™¨å¿«å–ï¼Œæ•¸æ“šä»ä¿å­˜åœ¨é›²ç«¯
4. **å‘ä¸‹å…¼å®¹**ï¼šå¦‚æœ API é€£ç·šå¤±æ•—ï¼Œä»å¯ä½¿ç”¨ localStorage æœ¬åœ°æ•¸æ“š

## ğŸ¯ æ¸¬è©¦å»ºè­°

### æ¸¬è©¦æ´¾èª²ç®¡ç†
1. é€²å…¥ã€Œæ´¾èª²ç®¡ç†ã€é é¢
2. æ–°å¢ä¸€ç­†æ´¾èª²è¨˜éŒ„
3. é‡æ–°æ•´ç†é é¢ï¼Œç¢ºèªæ•¸æ“šå·²å¾å¾Œç«¯è¼‰å…¥
4. æª¢æŸ¥ç€è¦½å™¨ Consoleï¼Œæ‡‰è©²çœ‹åˆ°ï¼š
   ```
   âœ… æ´¾èª²æ•¸æ“šå·²åŒæ­¥åˆ°å¾Œç«¯
   âœ… æ´¾èª²æ•¸æ“šå·²å¾å¾Œç«¯è¼‰å…¥ï¼Œå…± X ç­†
   ```

### æ¸¬è©¦æµ·äº‹èª²ç¨‹
1. é€²å…¥ã€Œæµ·äº‹èª²ç¨‹ã€é é¢ï¼ˆURL hash: #maritimeï¼‰
2. æ–°å¢æˆ–ç·¨è¼¯ä¸€ç­†èª²ç¨‹
3. é‡æ–°æ•´ç†é é¢ï¼Œç¢ºèªæ•¸æ“šå·²å¾å¾Œç«¯è¼‰å…¥
4. æª¢æŸ¥ç€è¦½å™¨ Consoleï¼Œæ‡‰è©²çœ‹åˆ°ï¼š
   ```
   âœ… æµ·äº‹èª²ç¨‹æ•¸æ“šå·²åŒæ­¥åˆ°å¾Œç«¯
   âœ… æµ·äº‹èª²ç¨‹æ•¸æ“šå·²å¾å¾Œç«¯è¼‰å…¥ï¼Œå…± X ç­†
   ```

### æ¸¬è©¦ API é€£ç·šç‹€æ…‹
1. åœ¨é é¢é ‚éƒ¨é»æ“Šã€Œæ¸¬è©¦ API é€£ç·šã€æŒ‰éˆ•
2. æ‡‰è©²é¡¯ç¤ºã€ŒAPI é€£ç·šæ­£å¸¸ã€
3. å¦‚æœå¤±æ•—ï¼Œç³»çµ±æœƒé™ç´šä½¿ç”¨æœ¬åœ°æ•¸æ“šï¼ˆgraceful degradationï¼‰

## ğŸ“ æ³¨æ„äº‹é …

1. **API URL é…ç½®**ï¼šç¢ºèª `js/api.js` ä¸­çš„ `baseUrl` æ˜¯å¦æ­£ç¢º
2. **Token èªè­‰**ï¼šç¢ºèª `token` èˆ‡å¾Œç«¯ `backend-api.gs` ä¸­çš„ TOKEN ä¸€è‡´
3. **CORS è¨­å®š**ï¼šå¾Œç«¯å·²è¨­ç½® `Access-Control-Allow-Origin: *`
4. **éŒ¯èª¤è™•ç†**ï¼šæ‰€æœ‰ API èª¿ç”¨éƒ½æœ‰ try-catchï¼Œå¤±æ•—æ™‚ä¸æœƒå½±éŸ¿ä½¿ç”¨è€…é«”é©—

## ğŸ”— ç›¸é—œæ–‡ä»¶

- å‰ç«¯ APIï¼š`js/api.js`
- å¾Œç«¯ç¨‹å¼ï¼š`backend-api.gs`
- å‰ç«¯é é¢ï¼š`teacher-management.html`

---

**æ•´åˆå®Œæˆï¼** ğŸ‰
